create table public.products (
  id uuid not null default extensions.uuid_generate_v4 (),
  tenant_id uuid not null,
  barcode text not null,
  name text not null,
  brand text null,
  category text null,
  supplier text null,
  unit text null default 'adet'::text,
  price numeric(10, 2) null,
  active boolean null default true,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  constraint products_pkey primary key (id),
  constraint products_tenant_id_barcode_key unique (tenant_id, barcode),
  constraint products_tenant_id_fkey foreign KEY (tenant_id) references tenants (id) on delete CASCADE
) TABLESPACE pg_default;

create index IF not exists idx_products_tenant on public.products using btree (tenant_id) TABLESPACE pg_default;

create index IF not exists idx_products_barcode on public.products using btree (tenant_id, barcode) TABLESPACE pg_default;

create index IF not exists idx_products_name_trgm on public.products using gin (name extensions.gin_trgm_ops) TABLESPACE pg_default;

create trigger update_products_updated_at BEFORE
update on products for EACH row
execute FUNCTION update_updated_at_column ();